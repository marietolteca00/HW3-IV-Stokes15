---
title: "Assignment 3: Instrumental Variable Estimation"
subtitle: "Replicating the IV strategy in Stokes (2015)"
author: "EDS 241 / ESM 244 (DUE: 2/17/2026)"
format:
  html:
    theme: sketchy
    css: styles.css
date: "February 10, 2026"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE)
```

------------------------------------------------------------------------

### Assignment instructions:

Working with classmates to troubleshoot code and concepts is encouraged. If you collaborate, list collaborators at the top of your submission.

All written responses must be written independently (in your own words).

Keep your work readable: Use clear headings and label plot elements thoughtfully (where applicable).

Submit both your rendered output and the Quarto (`.qmd`) file.

**Assignment submission (YOUR NAME)**: Marie tolteca


------------------------------------------------------------------------

### Introduction

In this assignment, you will replicate the instrumental variable analysis from Stokes (2015), which examined how local wind turbine projects influenced electoral outcomes. Building on the matched dataset from Assignment 2, we will use Two-Stage Least Squares (2SLS) to estimate the causal effect of having a wind turbine proposed nearby on the change in Liberal Party vote share between 2007 and 2011. The instrument used in Stokes (2015) is a measure of local wind resource (average wind power, logged), which predicts where wind turbines are proposed. By using this instrument, we aim to isolate the portion of variation in turbine placement that is as-good-as-random, helping to meet the assumptions for causal identification.

**Study:** [Stokes, 2015 â€“ Article](https://drive.google.com/file/d/1y2Okzjq2EA43AW5JzCvFS8ecLpeP6NKh/view?usp=drive_link)

**Data source:** [Dataverse â€“ Stokes, 2015 replication data](https://dataverse.harvard.edu/dataset.xhtml?persistentId=doi:10.7910/DVN/SDUGCC)

------------------------------------------------------------------------

::: callout
Note: The estimates you obtain may not exactly match the published results in Stokes (2015) due to the alternative matching procedure used for processing the data in the previous assignment. Estimates should approximate the findings reported in *Table 2* of the article.
:::

------------------------------------------------------------------------

### Load packages

```{r}
library(tidyverse)
library(janitor)
library(here)
library(jtools)   # for export_summs (pretty regression tables)
library(AER)      # for ivreg (2SLS estimation)

```

------------------------------------------------------------------------

### Load the matched dataset (from Assignment 2)

> The matched_data has been preprocessed by matching on key covariates (e.g. pretreatment home values, education, income, population density) to improve balance between treated and control precincts. We will now use this data for the IV analysis. Make sure to re-code the `precinct_id` variable as a `factor`. 

```{r}

matched_data <- read_csv(here('data','matched_data_subset.csv')) %>% 
    mutate(precinct_id = factor(precinct_id))

#Checking if the column is now a factor
class(matched_data$precinct_id)
```

------------------------------------------------------------------------

### Part 1: IV Identification Rationale

Intuition for Using an Instrument: 

**Question 1:** After matching on observables, why might we still need to utilize an instrumental variable approach to identify the causal effect of turbine proposals on vote share? In other words, what potential issues remain that an IV method can help address in this context? Use specific examples from the study to illustrate threats to a causal interpretation, then explain how an IV approach is designed to mitigate those threats.

*Response:* 
After matching on observables, we still need to utilize an instrumental variable approach because unobservable characteristics could still bias the causal estimate of turbine proposals on vote share.
Even though matching balances precincts on observable covariates like home values, education, income, and population density, there remain potential unobservable confounders that could threaten causal interpretation.
- Communities with stronger environmental activism might both attract turbines (developers expect receptiveness) AND vote differently due to political orientation
- Areas with weaker governance might be targeted for development (easier land agreements) AND have different baseline voting patterns
- Landowners hosting turbines might differ in unobservable ways (financial need, ideology) that correlate with community voting behavior
Wind speed (cubed) is orthogonal to political preferences (precinct boundaries) it's determined by geography/meteorology, not community characteristics. Developers chase wind resources for profit maximization under the feed in tariff, creating predicted placement variation in turbines.
The IV approach relies on the exclusion restriction: wind speed affects vote share only through turbine placement. This exploits exogenous variation in treatment assignment, isolating the causal effect while eliminating bias from unobservables that matching cannot address.

------------------------------------------------------------------------

### Part 2: Two-Stage Least Squares (2SLS) Step-Wise Implementation

#### 2A. First-Stage Estimation: Regress the treatment ($D$) on the instrument ($Z$)

$$D_i = \alpha_0 + \alpha_1 Z_i $$

a. Estimate the first-stage regression of the treatment on the instrument (with controls). Regress `proposed_turbine_3km` on `log_wind_power`.
b. Include the control variables used in Stokes (2015) for both stages: Distance to lakes, geographic coordinates (latitude & longitude) with their squares and interaction, plus district fixed effects. 
c. After running the first stage, report the F-statistic for the instrument.

```{r}
first_stage <- lm(proposed_turbine_3km ~ log_wind_power + mindistlake + long_lat + lat_sq + long_sq + district_id,
                  data = matched_data)

export_summs(first_stage, digits = 3,
             model.names = c("First stage: Prpoposed Turbine 3km"),
             coefs = c("(Intercept)", "log_wind_power")) 

# Extract the F-statistic for instrument strength
first_stage_summary <- summary(first_stage)
fstat <- (first_stage_summary$fstatistic[1])

print(paste("The F-Statistic:", round(first_stage_summary$fstatistic[1], 2)))

```

###  Testing Instrument Relevance

Check instrument strength (F-statistic)
**Assessing instrument strength**: A common rule of thumb is that the **F-statistic** on the excluded instrument(s) in the first stage should be greater than 10. An F-stat below 10 suggests a **weak instrument**, which can lead to biased IV estimates and unreliable inference.
- The F-Statistic in the first stage is greater than 10, it is at {fstat} indicating a strong instrument.
```{r}
print(paste("The F-Statistic:", round(first_stage_summary$fstatistic[1], 2)))
```

**Question 2A:** Based on the instrument relevance test reported in the study, would you conclude the instrument is strong enough to be credible? Explain what a weak instrument would mean in this setting: Specifically, what would it suggest about compliance with Ontarioâ€™s Green Energy Act policy? 

*Response:* Based on the instrument relevance test reported in the study, an F-statistic of {fstat} indicates a strong instrument at the first stage, confirming that wind power strongly predicts turbine placement in the first stage. If the f-statistic was less than 10 it would indicate a weak instrument which could lead to a biased IV estimates and unreliable inference. A weak instrument in this setting would suggest that wind resources did not primarily determine turbine placement, undermining the study's identification strategy. This would mean, developers were not simply chasing wind resources for profit maximization under the Green Energy Act, but instead may have selected sites based on political factors, local resistance levels, or community characteristics. The endogenous factors the IV approach is designed to eliminate. This would violate the assumption that wind speed provides as-if random variation in treatment assignment.

------------------------------------------------------------------------

#### 2B. Second Stage Estimation 

#### Regress the outcome ($Y$) on the fitted values from the 1st stage ($\hat{X}_i$)

$$Y_i = \beta_0 + \beta_1 \hat{D}_i + \epsilon_i$$

a. Now estimate the second stage of the 2SLS. 
b. First, use the first-stage model to generate the predicted values of proposed_turbine_3km for each precinct (these are $\hat{D}_i$). 
c. Add these predicted values as a new column in matched_data (e.g. proposed_turbine_3km_HAT). 
d. Then, regress the outcome change_liberal (the change in Liberal vote share from 2007 to 2011) on the predicted treatment (proposed_turbine_3km_HAT), including the same controls and fixed effects as in the first stage. 
e. Fill in the code for these steps below to obtain the second-stage regression results.

Save predicted values $\hat{X}_i$ from first stage 
```{r}
matched_data$proposed_turbine_3km_HAT <- predict(first_stage)

second_stage <- lm(change_liberal ~ proposed_turbine_3km_HAT + mindistlake + 
                   long_lat + lat_sq + long_sq + district_id,
                   data = matched_data)
```

#### Estimate the second-stage regression 

$$LiberalVoteShare_i = \beta_0 + \beta_1 \widehat{ProposedTurbine}_i + ControlVariables... +  \epsilon_i$$

```{r}
second_stage <- lm(change_liberal ~ proposed_turbine_3km_HAT + mindistlake + 
                   long_lat + lat_sq + long_sq + district_id,
                   data = matched_data)

export_summs(second_stage, digits = 3, 
             model.names = c("Second stage: Change in Liberal Vote Share"),
             coefs = c("(Intercept)", "proposed_turbine_3km_HAT") ) 
```

#### Interpreting the 2SLS Estimate

**Question 2B:** Imagine you are explaining your 2SLS findings to a policymaker in Ontario. What does the estimated coefficient on `proposed_turbine_3km_HAT` imply about the electoral impact of a local wind turbine proposal (within 3 km) on liberal vote share?
- In communities where a wind turbine proposal occurs within 3 km, Liberal candidates receive about 8 percentage points fewer votes than they otherwise would have, due to the presence of the proposal.

**Question 2C:** Explain what it means that IV identifies a LATE in the context of the wind-turbine voting study. What specific subset of observations does the second-stage 2SLS estimate apply to, and what does it imply about interpretation and generalizability? 
Local average treatment effect (LATE)
*Response:* 
-The IV estimate identifies a LATE for precincts whose exposure to turbine proposals is influenced by wind power (compliers). The result does not represent the average effect for all precincts, but only for those whose treatment status responds to wind resource quality, which limits generalizability.

------------------------------------------------------------------------

### Part 3: IV Assumptions and Validity

#### Evaluate Instrument Validity 

**Question 3:** List the four key assumptions required for the IV strategy (2SLS) to identify a causal effect, and briefly explain what each one means in the context of this study. (Hint: think about what conditions a valid instrument must satisfy (relevance, exclusion,...)

*Response:* 
1. Relevance: The instrument (wind speed) must strongly predict the treatment (wind turbine placement)
- Wind power strongly predicts where turbines are proposed (F = 56.94 > 10), confirming developers chase wind resources for profit under the Green Energy Act.
2. Exclusion Restriction: The instrument (wind speed) should not directly relate to the outcome (vote shoare for the incumbent government). The instrument should only relate to the outcome through treatment.
- Wind speed only affects voting behavior through turbine placement, not through other channels.
3. Exogeneity: The instrument is unrelated to unobserved factors, meaning it is independent of potential outcomes and unobserved confounders.
= Wind speed is determined by geography/meteorology, not by political preferences or community characteristics that influence voting.
4. Monotonicity: The instrument affects the treatment in one direction only.
= Higher wind speed never decreases the probability of turbine placement (developers wouldn't avoid high-wind areas under this profit maximizing policy).

------------------------------------------------------------------------

### Part 4: Estimate 2SLS using `AER::ivreg()` 

ðŸ“œ [SEE Documentation for specification details: AER package Viggnette Example](https://cran.r-project.org/web/packages/AER/vignettes/AER.pdf)

::: callout-tip

Syntax for specifying 2SLS using `ivreg()`:

`ivreg( Y ~ D + CONTROLS  | Z + CONTROLS , data )`

- The first-stage predictor variables go after the `~` symbol
- The second-stage predictor variables go after the `|` symbol

::: 


```{r}
fit_2sls <- ivreg(change_liberal ~ proposed_turbine_3km + mindistlake + 
                  long_lat + lat_sq + long_sq + district_id | 
                  log_wind_power + mindistlake + long_lat + lat_sq + 
                  long_sq + district_id,
                  data = matched_data)

export_summs(fit_2sls, digits = 3,
             model.names = c("Change in Liberal Vote Share"),
             coefs = c("(Intercept)", "proposed_turbine_3km")
             ) 
```

#### Robustness checking strategies utilized in Stokes, 2015

**Question 4:** Choose two *robustness checks* from the paper that the authors use to increase confidence in their causal identification strategy. For each one, summarize the logic and findings from the robustness check in your own words:

*Response:* _________________________ 

------------------------------------------------------------------------

### END

------------------------------------------------------------------------
